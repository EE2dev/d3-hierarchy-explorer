!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],n):n(t.reusableChart={},t.d3)}(this,function(t,W){"use strict";function i(t,n,e,r){if(void 0!==t)if(t.endsWith(".json"))W.json(t).then(function(t){console.log(t),r(n,t)});else if(t.endsWith(".csv")){var o=[];console.log(o),r(n,o)}else console.log("File must end with .json or csv");else{var i=W.select("aside#data").text(),a=W.csvParse(i.replace(/^\s+|\s+$|\s+(?=\s)/g,""));a.forEach(function(t){!function(t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=+t[n])}(t)}),e&&console.log(a),r(n,a)}}t.chart=function(e){var r={};function n(n){n.each(function(t){console.log(t),console.log("_myData "+e),void 0!==t?o(n,t):i(e,n,r.debugOn,o)})}function o(t,n){!function(t,n,u){var e,r=W.hierarchy,f=1400-u.margin.right-u.margin.left,s=800-u.margin.top-u.margin.bottom,h=void 0,g=void 0,p=void 0,y=void 0,m=void 0,x=20;function v(t){return"curved"===u.connector?"M"+t.y+","+t.x+"C"+(t.y+t.parent.y)/2+","+t.x+" "+(t.y+t.parent.y)/2+","+t.parent.x+" "+t.parent.y+","+t.parent.x:"M"+t.parent.y+","+t.parent.x+"V"+t.x+"H"+t.y}function b(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null),o(t)}function o(t){f=800;var n=p(y),e=[];n.eachBefore(function(t){e.push(t)}),s=Math.max(500,e.length*u.connectorHeight+u.margin.top+u.margin.bottom);var r=e.slice(1);e.forEach(function(t,n){t.x=n*u.connectorHeight}),W.select("svg").transition().duration(g).attr("height",s);var o=m.selectAll("g.node").data(e,function(t){return t.id||(t.id=++h)}),i=o.enter().append("g").attr("class","node").attr("transform",function(){return"translate("+t.y0+","+t.x0+")"}).on("click",b);i.append("circle").attr("r",1e-6).style("fill",function(t){return t._children?"lightsteelblue":"#fff"}),i.append("text").attr("x",10).attr("dy",".35em").attr("text-anchor","start").text(function(t){return t.data.name.length>x?t.data.name.substring(0,x)+"...":t.data.name}).style("fill-opacity",1e-6),i.append("svg:title").text(function(t){return t.data.name});var a=o.merge(i).transition().duration(g);a.attr("transform",function(t){return"translate("+t.y+","+t.x+")"}),a.select("circle").attr("r",4.5).style("fill",function(t){return t._children?"lightsteelblue":"#fff"}),a.select("text").style("fill-opacity",1);var c=o.exit().transition().duration(g);c.attr("transform",function(){return"translate("+t.y+","+t.x+")"}).remove(),c.select("circle").attr("r",1e-6),c.select("text").style("fill-opacity",1e-6);var l=m.selectAll("path.link").data(r,function(t){return t.id+"->"+t.parent.id}),d=l.enter().insert("path","g").attr("class","link").attr("d",function(){return v({x:t.x0,y:t.y0,parent:{x:t.x0,y:t.y0}})});l.merge(d).transition().duration(g).attr("d",v),l.exit().transition().duration(g).attr("d",function(){return v({x:t.x,y:t.y,parent:{x:t.x,y:t.y}})}).remove(),e.forEach(function(t){t.x0=t.x,t.y0=t.y})}e=n,h=0,g=750,p=W.tree().size([f,s]).nodeSize([0,u.connectorWidth]),(y=p(r(e))).each(function(t){t.name=t.id,t.id=h,h++}),y.x0=y.x,y.y0=y.y,m=t.append("svg").attr("width",f+u.margin.right+u.margin.left).attr("height",s+u.margin.top+u.margin.bottom).append("g").attr("transform","translate("+u.margin.left+","+u.margin.top+")"),u.updateConnectorWidth=function(){p.nodeSize([0,u.connectorWidth]),o(y)},u.updateConnectorHeight=function(){o(y)},o(y)}(t,n,r)}return r.connector="straight",r.connectorWidth=30,r.connectorHeight=50,r.margin={top:20,right:10,bottom:20,left:10},r.barPadding=1,r.fillColor="coral",r.debugOn=!1,n.debugOn=function(t){return arguments.length?(r.debugOn=t,n):r.debugOn},n.connector=function(t){return arguments.length?(r.connector=t,n):r.connector},n.margin=function(t){return arguments.length?(r.margin=t,n):r.margin},n.connectorWidth=function(t){return arguments.length?(r.connectorWidth=t,"function"==typeof r.updateConnectorWidth&&r.updateConnectorWidth(),n):r.connectorWidth},n.connectorHeight=function(t){return arguments.length?(r.connectorHeight=t,"function"==typeof r.updateConnectorHeight&&r.updateConnectorHeight(),n):r.connectorHeight},n},Object.defineProperty(t,"__esModule",{value:!0})});